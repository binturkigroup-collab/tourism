import{C as y,F as q,a as z,c as G,R as p,r as K,j as t,L as Q,b as X}from"./app-DiW-XT2R.js";import{M as Y}from"./MenuService-D7AcVvyS.js";import{S as j}from"./SocialEnum-kZ2r43n-.js";import{u as Z}from"./SnackbarHook-CcEHZ6yi.js";import{u as ee,F as te}from"./index.esm-7xo1ZZ6V.js";import{o as x,r as ae,b as se,s as c,t as re}from"./zod-BSnW4xGW.js";import{V as k}from"./ValidatedSelect-DfUES9ev.js";import{V as oe}from"./ValidatedInput-B47v1hwj.js";import{V as ne}from"./ValidatedSelectWithIcon-DRnOncDF.js";import{B as ie}from"./BasicTitleTranslation-CZ3c-ROF.js";import{V as v}from"./ValidatedSwitch-BMI7hK1p.js";import{C}from"./CustomButton-nEbszSQU.js";import{C as le}from"./CustomSnackbar-Dw7l-5cQ.js";import{D as me}from"./DeleteModal-vG7oVwY-.js";import{S as d}from"./SocialMenuEnum-BT2Ljc4O.js";import{B as S,T as M}from"./Box-BIlEOssd.js";import{S as T}from"./Send-DwzwYWJL.js";import"./InputAdornment-BF2v1MXS.js";import"./useSlot-D1jzCan3.js";import"./Select-1FYDYG3S.js";import"./Menu-bPvhPpmt.js";import"./isHostComponent-B2iQ8i1a.js";import"./Paper-BW67c0Rd.js";import"./Modal-C_Vi7S8X.js";import"./useControlled--Ee95RYi.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-D4hgghdo.js";import"./FormHelperText-Cjkp522a.js";import"./isMuiElement-tkmUoEbT.js";import"./MenuItem-GJkZjFZB.js";import"./listItemTextClasses-BxSQuiyo.js";import"./Icon-Cyiifixs.js";import"./mail-CSA8imBK.js";import"./createLucideIcon-CzejhRRW.js";import"./smartphone-D7WOu-Aq.js";import"./ListItemText-6SnngRZD.js";import"./FormControlLabel-BE9UflYY.js";import"./SwitchBase-CAo85LZi.js";import"./Button-3jDmhGPp.js";import"./IconButton-Cu0Qh6L-.js";const Ye=({category:o,menus:V,menu:u})=>{const L=y.get(q),l=y.get(z),n=y.get(Y),N=G().props.settings.languages,[s,A]=p.useState(u),[w,I]=p.useState(V),[F,B]=p.useState(s.type),[pe,ce]=p.useState(null),O=Object.values(d).map(e=>({id:e,name:e})),D=Object.keys(j).map(e=>({id:j[e],name:e})),{snackbar:g,setSnackbar:m,handleClose:E}=Z(),[R,f]=K.useState(!1),P=()=>{f(!1)},U=()=>{f(!0)},_=x({isActive:se().default(!0),menuType:x({type:c(),url:c()}).refine(({type:e,url:r})=>e===d.SOCIAL&&l.validateURL(r)||e===d.LIST,{message:"Choose correct type!",path:["url","type"]}),translations:ae(c().length(2),x({name:c().min(3,{message:"Name should be at least 3 characters!"})}))}),H=s.id<0?L.generateDefaultTitles(N):n.getTranslationsDetails(s.translations),a=ee({mode:"onBlur",reValidateMode:"onBlur",resolver:re(_),defaultValues:{parent:s.parentId,isActive:s.isActive,menuType:{url:s.url||"",type:s.type,image:s.image||"facebook"},target:s.target==="_blank",translations:H}}),$=(e,r)=>{B(e.target.value)},J=()=>{const e=new FormData,r=a.getValues("target")?"_blank":"_self";e.append("parentId",String(a.getValues("parent"))),e.append("category",o),e.append("name",o+"-menu"),e.append("order","1"),e.append("target",r),e.append("isActive",String(a.getValues("isActive"))),e.append("type",a.getValues("menuType.type")),e.append("translations",JSON.stringify(a.getValues("translations"))),e.append("url",a.getValues("menuType.url")),e.append("image",a.getValues("menuType.image")),n.updateMenu(e,s.id).then(h=>{A(h.data),I(i=>i.map(b=>b.id===s.id?h.data:b)),m(i=>({...i,open:!0,message:"Link has been updated",severity:"success"}))}).catch(h=>{m(i=>({...i,open:!0,message:"Error Happened while updating link",severity:"error"}))})},W=()=>{f(!1),n.deleteMenu(u.id).then(e=>{m(r=>({...r,open:!0,message:"Link has been deleted!",severity:"success"})),X.get("/admin/get-menu/"+u.category)}).catch(e=>{m(r=>({...r,open:!0,message:"Error Happened while deleting Link!",severity:"error"}))})};return t.jsxs(S,{children:[t.jsxs(T,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(M,{variant:"h5",children:"Update "+n.getMenuName(s)}),t.jsx(Q,{href:`/admin/get-menu/${o}`,children:t.jsx(M,{variant:"h5",children:"Back"})})]}),t.jsx(te,{...a,children:t.jsxs(S,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"100%"}},noValidate:!0,autoComplete:"off",onSubmit:a.handleSubmit(J),children:[t.jsx(k,{control:a.control,controlName:"parent",id:"parent",label:"Parent Link",placeholder:"Parent Link",items:n.getAllTranslations(w,!0)}),t.jsx(k,{control:a.control,controlName:"menuType.type",id:"type",label:"Link Type",placeholder:"Link Type",items:O,withNone:!1,selectChanged:$}),F===d.SOCIAL&&t.jsxs(S,{children:[t.jsx(oe,{name:"url",id:"url",controlName:"menuType.url",methods:a,label:"URL",placeholder:"https://facebook.com"}),t.jsx(ne,{control:a.control,controlName:"menuType.image",id:"image",label:"Icon",placeholder:"Facebook",items:D,withNone:!1})]}),t.jsx(ie,{methods:a,category:l.toTitleCase(o)}),t.jsxs(T,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(v,{controlName:"isActive",name:"isActive",id:"isActive",color:"secondary",methods:a,label:"Is Active?"}),t.jsx(v,{controlName:"target",name:"target",id:"target",color:"secondary",methods:a,label:"Open in a new tab?"})]}),t.jsxs(T,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(C,{task:"update",text:l.toTitleCase(o)}),t.jsx(C,{type:"button",task:"delete",text:l.toTitleCase(o),onClick:U})]})]})}),t.jsx(le,{open:g.open,message:g.message,onClose:E,severity:g.severity}),t.jsx(me,{open:R,onClose:P,message:`Are you sure that you want to delete ${n.getMenuName(s)}`,confirmDelete:W})]})};export{Ye as default};

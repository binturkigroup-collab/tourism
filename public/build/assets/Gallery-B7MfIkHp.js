import{C as b,r as h,R as k,j as e}from"./app-B05HYnb3.js";import{F as y}from"./FileService-EkWN1P3I.js";import{I as v}from"./Icon-Dao_BtV8.js";import{B as j}from"./Box-RV04XL3h.js";import{C as E}from"./CardMedia-O2vWruZY.js";import{A as M}from"./Avatar-CW627ElJ.js";import{I as L}from"./IconButton-B3gEuC88.js";import{M as F}from"./Menu-BVfd7xCs.js";import{M as D}from"./MenuItem-B8b56AnY.js";import{L as A}from"./ListItemIcon-C6KgXvLR.js";import{L as w}from"./ListItemText-Ir23mb16.js";import{F as H}from"./FormHelperText-Qr84Mdnz.js";import{C as N}from"./CustomButton-CJVVLJmt.js";import{D as U}from"./DeleteModal-BocftlnO.js";import{B as O}from"./BlockService-Dra7VTvY.js";import{u as z}from"./SnackbarHook-CiBrGsL4.js";import"./Paper-Bv3sIEco.js";import"./useSlot-xgwQKnQ5.js";import"./Send-ZAnJecau.js";import"./mail-wIstfkvy.js";import"./createLucideIcon-CqSzLRzo.js";import"./smartphone-Bx5cTzbE.js";import"./isHostComponent-C3L2UNi8.js";import"./Modal-Cn09HyHg.js";import"./listItemTextClasses-CNzp_QZz.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-BofjglMm.js";import"./Button-C2eAeK6r.js";const P=n=>{const p=b.get(y),[m,d]=h.useState(!1);return h.useEffect(()=>{d(p.assertImage(n))},[n]),m},T=({className:n="relative",classes:p="",image:m=null,imageChanged:d,imageDelete:g})=>{const[l,o]=h.useState(null),[u,f]=h.useState(""),x=b.get(y),a=h.useRef(null),[r,s]=k.useState(null),t=!!r,c=()=>{s(null)},i=I=>{s(I.currentTarget)},C=()=>{a.current?.click(),c()},S=P(l),B=I=>{I&&I.target&&(x.assertSize(I.target?.files?.[0])?x.assertImage(I.target?.files?.[0])?(f(""),d(I.target?.files?.[0])):f("Please upload an image!"):f("Image Size must be less than 200KB!"))},R=()=>{g(),c()};return e.jsxs(j,{children:[e.jsx(E,{classes:p,component:"img",src:S&&l?URL.createObjectURL(l):m||x.DefaultImage,alt:"photo",className:n}),e.jsxs(j,{className:"absolute top-[16px] right-[16px] rounded-full",children:[e.jsx(M,{sx:{bgcolor:"rgba(0,0,0,0.52)"},children:e.jsx(L,{id:"basic-button","aria-controls":t?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":t?"true":void 0,onClick:i,sx:{color:"white"},children:e.jsx(v,{name:"vertical-dots"})})}),e.jsxs(F,{id:"basic-menu",anchorEl:r,open:t,onClose:c,MenuListProps:{"aria-labelledby":"basic-button"},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[e.jsxs(D,{onClick:C,children:[e.jsx(A,{children:e.jsx(v,{name:"edit"})}),e.jsx(w,{children:"Update"})]}),e.jsxs(D,{onClick:R,children:[e.jsx(A,{children:e.jsx(v,{name:"delete"})}),e.jsx(w,{children:"Delete"})]})]})]}),e.jsx("input",{type:"file",id:"hidden-input",className:"hidden",ref:a,onChange:B}),u&&e.jsx(H,{sx:{color:"error.main",marginLeft:"8px",marginRight:"8px",textWrap:"nowrap"},children:u})]})},G=({imageChanged:n,text:p="Product"})=>{const m=b.get(y),d=h.useRef(null),g=()=>{d.current?.click()},l=o=>{o&&o.target&&m.assertImage(o.target?.files?.[0])&&n(o.target?.files?.[0])};return e.jsxs(j,{children:[e.jsx(N,{task:"add",text:`${p} image`,onClick:g}),e.jsx("input",{type:"file",id:"hidden-input",className:"hidden",ref:d,onChange:l})]})},K=({images:n,callbackImageUrl:p,addImage:m,updateImage:d,deleteImage:g,text:l="product"})=>{const[o,u]=h.useState(!1),[f,x]=h.useState(0),a=()=>{u(!1)},r=i=>{x(i),u(!0)},s=i=>{m(i)},t=(i,C)=>{d(i,C)},c=()=>{g(f),u(!1)};return e.jsxs(j,{children:[e.jsx(j,{className:"px-[16px]",children:e.jsx(G,{text:l,imageChanged:i=>s(i)})}),e.jsx(j,{className:"flex flex-wrap items-start content-center justify-start p-[16px] gap-[16px]",children:n.map((i,C)=>e.jsx(j,{className:"w-[250px] relative",children:e.jsx(T,{classes:{img:"bg-center bg-cover object-cover  h-[195px] rounded-lg border-2 border-state-500"},imageChanged:S=>t(S,i.id),imageDelete:()=>r(i.id),image:p(i.url)})},C))}),e.jsx(U,{open:o,onClose:a,message:"Are you sure you want to delete this image?",confirmDelete:c})]})},Ie=({block:n})=>{const[p,m]=k.useState({...n}),[d,g]=k.useState(n.images.filter(a=>!a.isCover)),l=b.get(O),{setSnackbar:o}=z(),u=a=>{const r=new FormData;r.append("image",a),r.append("isCover","false"),l.addImage(r,p.id).then(s=>{m(s.data),g(s.data.images.filter(t=>!t.isCover)),o(t=>({...t,open:!0,message:"Image has been added!",severity:"success"}))}).catch(s=>{o(t=>({...t,open:!0,message:"Error Happened while adding image!",severity:"error"}))})},f=(a,r)=>{const s=new FormData;s.append("image",a),s.append("imageId",String(r)),l.uploadImage(s,n.id).then(t=>{m(t.data),g(t.data.images.filter(c=>!c.isCover)),o(c=>({...c,open:!0,message:"Image has been updated!",severity:"success"}))}).catch(t=>{o(c=>({...c,open:!0,message:"Error Happened while uploading image!",severity:"error"}))})},x=a=>{const r=new FormData;r.append("imageId",String(a)),l.deleteImage(r,n.id).then(s=>{m(s.data),g(s.data.images.filter(t=>!t.isCover)),o(t=>({...t,open:!0,message:"Image has been deleted!",severity:"success"}))}).catch(s=>{o(t=>({...t,open:!0,message:"Error Happened while deleting image!",severity:"error"}))})};return e.jsx(K,{images:d,callbackImageUrl:l.getImageUrl,addImage:a=>u(a),updateImage:(a,r)=>f(a,r),deleteImage:a=>x(a),text:"Gallery"})};export{Ie as default};

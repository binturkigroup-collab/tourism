import{j as e,R as l,C as p,r as C}from"./app-C3wK80uY.js";import{C as v}from"./index.esm-CmhnqTjL.js";import{F as m}from"./FileService-Be3-XDpa.js";import{C as b}from"./CardMedia-0mGhT63-.js";import{I as S}from"./Icon-8M-402I0.js";import{B as g}from"./Box-DXkLJjvK.js";import{I as R}from"./IconButton-DcP_xRJ9.js";import{F as E}from"./FormHelperText-QuUs-8Rq.js";const w={image:"",classes:"",className:"",callback:()=>{},imageChanged:()=>{},inputRef:l.createRef(),error:"",iconClasses:""},I=l.createContext(w),N=({value:s,children:t})=>e.jsx(I.Provider,{value:s,children:t}),u=()=>{const s=l.useContext(I);if(s===void 0)throw new Error("The context must be inside the provider");return s},k=()=>{const{inputRef:s,callback:t}=u(),r=a=>{t(a?.target?.files?.[0]||null)};return e.jsx("input",{type:"file",id:"hidden-input",className:"hidden",ref:s,onChange:r})},F=()=>{p.get(m);const{image:s,classes:t,className:r}=u();return(n=>n.toLowerCase().endsWith(".svg"))(s||"")?e.jsx("object",{className:t,data:s||"",type:"image/svg+xml",width:"100%",height:"100%",children:e.jsx("img",{src:s||"",width:"160px",height:"160px",alt:"svg fallback"})}):e.jsx(b,{classes:{img:t},component:"img",image:s||"/file/users/default.png",alt:"photo",className:r})},L=()=>{const{inputRef:s,iconClasses:t}=u(),r=()=>{s?.current?.click()};return e.jsx(g,{className:`absolute bg-white rounded-full ${t||"right-[16px] bottom-[16px]"}`,children:e.jsx(R,{onClick:r,className:"",children:e.jsx(S,{name:"edit",size:24})})})},V=()=>{const{error:s}=u();return s&&e.jsx(E,{sx:{color:"error.main",marginLeft:"8px",marginRight:"8px",textWrap:"nowrap"},children:s})},y=({image:s,onChange:t,iconClasses:r="",classes:a})=>{const n=p.get(m),[x,d]=l.useState(s),[h,c]=l.useState(""),f=l.useRef(null),o=i=>{i&&(n.assertSize(i)?n.assertImage(i)?(c(""),d(URL.createObjectURL(i)),t(i)):c("Please upload an image!"):c(`Image Size must be less than ${m.MAX_FILE_SIZE}KB!`))},j=()=>{};return e.jsx(N,{value:{image:x,callback:o,imageChanged:j,inputRef:f,error:h,iconClasses:r,classes:a},children:e.jsxs(g,{children:[e.jsxs(g,{className:"relative",children:[e.jsx(F,{}),e.jsx(L,{})]}),e.jsx(k,{}),e.jsx(V,{})]})})},$=({controllerName:s="",methods:t,image:r=null,onUpload:a=null})=>{const n=p.get(m),[x,d]=C.useState(!1),[h,c]=C.useState(!1),f=o=>{d(!0),t.setValue("image",o),o?t.clearErrors("image"):t.setError("image",{message:"image is required"}),!o&&x?t.setError("image",{message:"Select a valid image"}):(t.clearErrors("image"),a!==null&&a())};return e.jsx(v,{name:s,control:t.control,render:({field:{value:o,onChange:j,onBlur:i,ref:B},fieldState:{error:U}})=>e.jsx(e.Fragment,{children:e.jsx(g,{className:"w-[250px] relative",children:e.jsx(y,{image:r||n.DefaultImage,iconClasses:"right-[16px] bottom-[16px]",classes:"bg-center bg-cover object-cover relative h-[195px] rounded-lg border-2 border-state-500",onChange:f})})})})};export{$ as V};

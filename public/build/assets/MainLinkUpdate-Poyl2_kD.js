import{C as k,F as Q,a as W,c as X,R as g,r as Y,j as t,L as Z,b as ee}from"./app-DiW-XT2R.js";import{M as te}from"./MenuService-D7AcVvyS.js";import{B as ae}from"./BlockCategories-gKFyJIeZ.js";import{S as F}from"./SocialEnum-kZ2r43n-.js";import{u as se}from"./SnackbarHook-CcEHZ6yi.js";import{u as ne,F as re}from"./index.esm-7xo1ZZ6V.js";import{o as j,r as oe,b as ie,s as f,t as le}from"./zod-BSnW4xGW.js";import{V as v}from"./ValidatedSelect-DfUES9ev.js";import{A as pe}from"./AddFileButton-BB6BiUHi.js";import{B as me}from"./BasicTitleTranslation-CZ3c-ROF.js";import{V as N}from"./ValidatedSwitch-BMI7hK1p.js";import{C as w}from"./CustomButton-nEbszSQU.js";import{C as ce}from"./CustomSnackbar-Dw7l-5cQ.js";import{D as de}from"./DeleteModal-vG7oVwY-.js";import{M as o}from"./MainMenuTypesEnum-Fo6Ln7rd.js";import{B as S,T as C}from"./Box-BIlEOssd.js";import{S as y}from"./Send-DwzwYWJL.js";import"./InputAdornment-BF2v1MXS.js";import"./useSlot-D1jzCan3.js";import"./Select-1FYDYG3S.js";import"./Menu-bPvhPpmt.js";import"./isHostComponent-B2iQ8i1a.js";import"./Paper-BW67c0Rd.js";import"./Modal-C_Vi7S8X.js";import"./useControlled--Ee95RYi.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-D4hgghdo.js";import"./FormHelperText-Cjkp522a.js";import"./isMuiElement-tkmUoEbT.js";import"./MenuItem-GJkZjFZB.js";import"./listItemTextClasses-BxSQuiyo.js";import"./FileService-B_VouSkN.js";import"./ValidatedInput-B47v1hwj.js";import"./FormControlLabel-BE9UflYY.js";import"./SwitchBase-CAo85LZi.js";import"./Button-3jDmhGPp.js";import"./IconButton-Cu0Qh6L-.js";const We=({category:i,menus:V,menu:h})=>{const A=k.get(Q),x=k.get(W),l=k.get(te),I=X().props.settings.languages,[a,M]=g.useState(h),[E,L]=g.useState(V),[m,O]=g.useState(a.type),[u,B]=g.useState(null);console.log("category: ",i);const D=Object.values(o).map(e=>({id:e,name:e})),H=Object.values(ae).map(e=>({id:e,name:e}));Object.keys(F).map(e=>({id:F[e],name:e}));const{snackbar:T,setSnackbar:c,handleClose:P}=se(),[_,b]=Y.useState(!1),K=()=>{b(!1)},R=()=>{b(!0)},U=j({isActive:ie().default(!0),menuType:j({type:f(),blockType:f()}).refine(({type:e,blockType:n})=>e===o.BLOCK&&n.length||e===o.FILE||e===o.LIST||e===o.HOME,{message:"Choose correct type!",path:["blockType","type"]}),translations:oe(f().length(2),j({name:f().min(3,{message:"Name should be at least 3 characters!"})}))}),$=a.id<0?A.generateDefaultTitles(I):l.getTranslationsDetails(a.translations),s=ne({mode:"onBlur",reValidateMode:"onBlur",resolver:le(U),defaultValues:{parent:a.parentId,isActive:a.isActive,menuType:{type:a.type||"",blockType:a.blockType||""},target:a.target==="_blank",file:a.file?a.file.name:null,translations:$}}),z=(e,n)=>{O(e.target.value),B(null)},J=e=>{B(e),e&&s.setValue("file",e.name);const n=new FormData;n.append("fileId",String(a.file?.id||"-1")),n.append("file",e),n.append("type",m),l.updateFile(n,a.id).then(p=>{M(p.data),L(r=>r.map(d=>d.id===a.id?p.data:d)),c(r=>({...r,open:!0,message:"File has been uploaded",severity:"success"}))}).catch(p=>{c(r=>({...r,open:!0,message:"Error Happened while updating file",severity:"error"}))})},q=()=>{const e=new FormData,n=s.getValues("target")?"_blank":"_self";e.append("parentId",String(s.getValues("parent"))),e.append("category",i),e.append("name",i+"-menu"),e.append("order","1"),e.append("target",n),e.append("isActive",String(s.getValues("isActive"))),e.append("type",s.getValues("menuType.type")),e.append("translations",JSON.stringify(s.getValues("translations"))),m===o.BLOCK&&e.append("blockType",s.getValues("menuType.blockType")),m===o.FILE&&e.append("file",u),!(m===o.FILE&&!u)&&l.updateMenu(e,a.id).then(p=>{M(p.data),L(r=>r.map(d=>d.id===a.id?p.data:d)),c(r=>({...r,open:!0,message:"Link has been updated",severity:"success"}))}).catch(p=>{c(r=>({...r,open:!0,message:"Error Happened while updating link",severity:"error"}))})},G=()=>{b(!1),l.deleteMenu(h.id).then(e=>{c(n=>({...n,open:!0,message:"Link has been deleted!",severity:"success"})),ee.get("/admin/get-menu/"+h.category)}).catch(e=>{c(n=>({...n,open:!0,message:"Error Happened while deleting Link!",severity:"error"}))})};return t.jsxs(S,{children:[t.jsxs(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(C,{variant:"h5",children:"Update "+l.getMenuName(a)}),t.jsx(Z,{href:`/admin/get-menu/${i}`,children:t.jsx(C,{variant:"h5",children:"Back"})})]}),t.jsx(re,{...s,children:t.jsxs(S,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"100%"}},noValidate:!0,autoComplete:"off",onSubmit:s.handleSubmit(q),children:[t.jsx(v,{control:s.control,controlName:"parent",id:"parent",label:"Parent Link",placeholder:"Parent Link",items:l.getAllTranslations(E,!0)}),t.jsx(v,{control:s.control,controlName:"menuType.type",id:"type",label:"Link Type",placeholder:"Link Type",items:D,withNone:!1,selectChanged:z}),m===o.BLOCK&&t.jsx(v,{control:s.control,controlName:"menuType.blockType",id:"blockType",label:"Block Type",placeholder:"Block Type",items:H,withNone:!1}),m===o.FILE&&t.jsxs(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(S,{className:"m-[8px]",children:t.jsx(pe,{fileChanged:J,text:"Customized",type:"button"})}),u&&t.jsx(C,{variant:"subtitle2",children:u?.name})]}),t.jsx(me,{methods:s,category:x.toTitleCase(i)}),t.jsxs(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(N,{controlName:"isActive",name:"isActive",id:"isActive",color:"secondary",methods:s,label:"Is Active?"}),t.jsx(N,{controlName:"target",name:"target",id:"target",color:"secondary",methods:s,label:"Open in a new tab?"})]}),t.jsxs(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[t.jsx(w,{task:"update",text:x.toTitleCase(i)}),t.jsx(w,{type:"button",task:"delete",text:x.toTitleCase(i),onClick:R})]})]})}),t.jsx(ce,{open:T.open,message:T.message,onClose:P,severity:T.severity}),t.jsx(de,{open:_,onClose:K,message:`Are you sure that you want to delete ${l.getMenuName(a)}`,confirmDelete:G})]})};export{We as default};

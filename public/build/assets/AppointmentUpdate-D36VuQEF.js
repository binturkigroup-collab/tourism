import{C as n,a as V,F as w,R as m,j as e,H as T,L as I,b as F}from"./app-C3wK80uY.js";import{A as M}from"./AdminLayout-Bn0_Hkt7.js";import{B as N}from"./BlockService-BwsXifcj.js";import{A as H}from"./AppointmentService-CNbiKTJr.js";import{B as P}from"./BlockCategories-gKFyJIeZ.js";import{u as E,F as R}from"./index.esm-CmhnqTjL.js";import{o as L,d as U,s as O,t as _}from"./zod-B5AMIXlb.js";import{u as q}from"./SnackbarHook-vWpH4Y2e.js";import{V as z}from"./ValidatedCheckbox-U0fQ8zdE.js";import{V as G}from"./ValidatedSelect-lEDzcdS4.js";import{V as J}from"./ValidatedDatePicker-CcQv23_j.js";import{C as g}from"./CustomButton-C3dP_EVb.js";import{C as K}from"./CustomSnackbar-G8VUdTuF.js";import{D as Q}from"./DeleteModal-BYkbcGPj.js";import{B as p,T as x}from"./Box-DXkLJjvK.js";import{B as W}from"./Breadcrumbs-qP-bux-K.js";import{S as X}from"./Send-MfSLearV.js";import"./styles.module-DNUDPVkR.js";import"./Icon-8M-402I0.js";import"./Paper-BEwslr8d.js";import"./useSlot-D00As9hZ.js";import"./mail-DB0D0Sj1.js";import"./createLucideIcon-CcfZQpLF.js";import"./smartphone-Ba5ETqIJ.js";import"./isHostComponent-CYuES88E.js";import"./MenuItem-CqmEd7jq.js";import"./listItemTextClasses-BIi4qrrm.js";import"./listItemButtonClasses-HyWYRFaA.js";import"./ListItemIcon-DD3KcyQi.js";import"./ListItemText-CY5tp-cQ.js";import"./hook-BoUlgXeS.js";import"./Avatar-CTIonlLm.js";import"./IconButton-DcP_xRJ9.js";import"./Menu-Bg2AoiNO.js";import"./Modal-BOfQSbY0.js";import"./ThemeProvider-DYsQb5zk.js";import"./FormControlLabel-Dp1z-5Nj.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-Cr1AHk0s.js";import"./Checkbox-DozM_A5U.js";import"./SwitchBase-5Owp2XW5.js";import"./useControlled-BhUtEkbl.js";import"./InputAdornment-WpRiTsae.js";import"./Select-50sKScyd.js";import"./FormHelperText-QuUs-8Rq.js";import"./isMuiElement-CBKBaUeV.js";import"./index-Br-YPJKH.js";import"./Popper-CeL32HvH.js";import"./Button-DN2uCHAG.js";import"./ListItem-BXiNssqK.js";import"./Chip-cLQvExS1.js";const Qe=({appointment:c})=>{const u=n.get(N);n.get(V);const f=n.get(H),k=n.get(w),[h,S]=m.useState([]),[s,b]=m.useState(c),v=L({blockId:O({message:"Please determine the trip"}).refine(t=>k.isPositive(t)),startDate:U({message:"Date is required!"})}),o=E({mode:"onBlur",reValidateMode:"onBlur",resolver:_(v),defaultValues:{blockId:s.blockId.toString(),startDate:new Date(s.startDate),isActive:s.isActive}}),{snackbar:l,setSnackbar:i,handleClose:j}=q(),[A,d]=m.useState(!1),y=()=>{d(!1)},D=()=>{d(!0)};m.useEffect(()=>{u.getActiveBlocks(P.TRIP).then(t=>{S(t.data)})},[]);const C=()=>{const t=new FormData;t.append("blockId",String(o.getValues("blockId"))),t.append("startDate",new Date(o.getValues("startDate")).toDateString()),t.append("isActive",String(o.getValues("isActive"))),f.update(t,c.id).then(a=>{console.log("response",a.data.appointment),b(a.data.appointment),i(r=>({...r,open:!0,message:"A new appointment has been added",severity:"success"}))}).catch(a=>{i(r=>({...r,open:!0,message:"Error Happened while storing appointment",severity:"error"}))})},B=()=>{d(!1);const t=new FormData;t.append("category","appointment"),f.destroy(c.id,t).then(a=>{i(r=>({...r,open:!0,message:"Block has been deleted!",severity:"success"})),F.get("/admin/appointments")}).catch(a=>{i(r=>({...r,open:!0,message:"Error Happened while deleting block!",severity:"error"}))})};return e.jsxs(M,{children:[e.jsx(T,{title:"Appointments"}),e.jsx(p,{className:"py-[16px]",children:e.jsxs(p,{children:[e.jsxs(W,{children:[e.jsx(I,{href:"/admin/appointments",children:"Back to Appointments"}),e.jsxs(x,{children:["Update ",s.trip]})]}),e.jsx(p,{className:"p-[16px]",children:e.jsxs(x,{variant:"h5",children:["Update ",s.trip]})}),e.jsx(R,{...o,children:e.jsxs(p,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"100%"}},noValidate:!0,autoComplete:"off",onSubmit:o.handleSubmit(C),children:[e.jsx(z,{name:"isActive",id:"isActive",color:"secondary",control:o.control,label:"Is Active"}),h.length>0&&e.jsx(G,{control:o.control,controlName:"blockId",id:"blockId",label:"Trip",placeholder:"Trip",withNone:!1,items:h.map(t=>({id:t.id.toString(),name:u.getBlockName(t)}))}),e.jsx(J,{controlName:"startDate",methods:o,label:"Trip Date"}),e.jsxs(X,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[e.jsx(g,{task:"update",text:""}),e.jsx(g,{task:"delete",text:"",onClick:D})]})]})}),e.jsx(K,{open:l.open,message:l.message,onClose:j,severity:l.severity}),e.jsx(Q,{open:A,onClose:y,message:"Are you sure that you want to delete this appointment?",confirmDelete:B})]})})]})};export{Qe as default};

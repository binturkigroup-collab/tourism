import{C as n,a as V,F as w,R as m,j as e,H as T,L as I,b as F}from"./app-DiW-XT2R.js";import{A as M}from"./AdminLayout-BncvC458.js";import{B as N}from"./BlockService-B1hVAasl.js";import{A as H}from"./AppointmentService-lEwwiXpp.js";import{B as P}from"./BlockCategories-gKFyJIeZ.js";import{u as E,F as R}from"./index.esm-7xo1ZZ6V.js";import{o as L,d as U,s as O,t as _}from"./zod-BSnW4xGW.js";import{u as q}from"./SnackbarHook-CcEHZ6yi.js";import{V as z}from"./ValidatedCheckbox-Do-plhcJ.js";import{V as G}from"./ValidatedSelect-DfUES9ev.js";import{V as J}from"./ValidatedDatePicker-BN60rbp6.js";import{C as g}from"./CustomButton-nEbszSQU.js";import{C as K}from"./CustomSnackbar-Dw7l-5cQ.js";import{D as Q}from"./DeleteModal-vG7oVwY-.js";import{B as p,T as x}from"./Box-BIlEOssd.js";import{B as W}from"./Breadcrumbs-CyVMMUL3.js";import{S as X}from"./Send-DwzwYWJL.js";import"./styles.module-DNUDPVkR.js";import"./Icon-Cyiifixs.js";import"./Paper-BW67c0Rd.js";import"./useSlot-D1jzCan3.js";import"./mail-CSA8imBK.js";import"./createLucideIcon-CzejhRRW.js";import"./smartphone-D7WOu-Aq.js";import"./isHostComponent-B2iQ8i1a.js";import"./MenuItem-GJkZjFZB.js";import"./listItemTextClasses-BxSQuiyo.js";import"./listItemButtonClasses-BKDzk8Yp.js";import"./ListItemIcon-lfoxkzoc.js";import"./ListItemText-6SnngRZD.js";import"./hook-ChxrQmvj.js";import"./Avatar-BaiBLuYk.js";import"./IconButton-Cu0Qh6L-.js";import"./Menu-bPvhPpmt.js";import"./Modal-C_Vi7S8X.js";import"./ThemeProvider-tTCgpLcA.js";import"./FormControlLabel-BE9UflYY.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-D4hgghdo.js";import"./Checkbox-6Ob7jcJb.js";import"./SwitchBase-CAo85LZi.js";import"./useControlled--Ee95RYi.js";import"./InputAdornment-BF2v1MXS.js";import"./Select-1FYDYG3S.js";import"./FormHelperText-Cjkp522a.js";import"./isMuiElement-tkmUoEbT.js";import"./index-DbsX50-t.js";import"./Popper-C22uOTAg.js";import"./Button-3jDmhGPp.js";import"./ListItem-CDZqcBXO.js";import"./Chip-D6wlp6tT.js";const Qe=({appointment:c})=>{const u=n.get(N);n.get(V);const f=n.get(H),k=n.get(w),[h,S]=m.useState([]),[s,b]=m.useState(c),v=L({blockId:O({message:"Please determine the trip"}).refine(t=>k.isPositive(t)),startDate:U({message:"Date is required!"})}),o=E({mode:"onBlur",reValidateMode:"onBlur",resolver:_(v),defaultValues:{blockId:s.blockId.toString(),startDate:new Date(s.startDate),isActive:s.isActive}}),{snackbar:l,setSnackbar:i,handleClose:j}=q(),[A,d]=m.useState(!1),y=()=>{d(!1)},D=()=>{d(!0)};m.useEffect(()=>{u.getActiveBlocks(P.TRIP).then(t=>{S(t.data)})},[]);const C=()=>{const t=new FormData;t.append("blockId",String(o.getValues("blockId"))),t.append("startDate",new Date(o.getValues("startDate")).toDateString()),t.append("isActive",String(o.getValues("isActive"))),f.update(t,c.id).then(a=>{console.log("response",a.data.appointment),b(a.data.appointment),i(r=>({...r,open:!0,message:"A new appointment has been added",severity:"success"}))}).catch(a=>{i(r=>({...r,open:!0,message:"Error Happened while storing appointment",severity:"error"}))})},B=()=>{d(!1);const t=new FormData;t.append("category","appointment"),f.destroy(c.id,t).then(a=>{i(r=>({...r,open:!0,message:"Block has been deleted!",severity:"success"})),F.get("/admin/appointments")}).catch(a=>{i(r=>({...r,open:!0,message:"Error Happened while deleting block!",severity:"error"}))})};return e.jsxs(M,{children:[e.jsx(T,{title:"Appointments"}),e.jsx(p,{className:"py-[16px]",children:e.jsxs(p,{children:[e.jsxs(W,{children:[e.jsx(I,{href:"/admin/appointments",children:"Back to Appointments"}),e.jsxs(x,{children:["Update ",s.trip]})]}),e.jsx(p,{className:"p-[16px]",children:e.jsxs(x,{variant:"h5",children:["Update ",s.trip]})}),e.jsx(R,{...o,children:e.jsxs(p,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"100%"}},noValidate:!0,autoComplete:"off",onSubmit:o.handleSubmit(C),children:[e.jsx(z,{name:"isActive",id:"isActive",color:"secondary",control:o.control,label:"Is Active"}),h.length>0&&e.jsx(G,{control:o.control,controlName:"blockId",id:"blockId",label:"Trip",placeholder:"Trip",withNone:!1,items:h.map(t=>({id:t.id.toString(),name:u.getBlockName(t)}))}),e.jsx(J,{controlName:"startDate",methods:o,label:"Trip Date"}),e.jsxs(X,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:[e.jsx(g,{task:"update",text:""}),e.jsx(g,{task:"delete",text:"",onClick:D})]})]})}),e.jsx(K,{open:l.open,message:l.message,onClose:j,severity:l.severity}),e.jsx(Q,{open:A,onClose:y,message:"Are you sure that you want to delete this appointment?",confirmDelete:B})]})})]})};export{Qe as default};

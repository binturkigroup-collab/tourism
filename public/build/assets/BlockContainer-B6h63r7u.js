import{j as e,R as x,L as D,C as j,a as k,H as O}from"./app-C3wK80uY.js";import{C as S}from"./CustomButton-C3dP_EVb.js";import{A as _}from"./AdminLayout-Bn0_Hkt7.js";import{B as L}from"./BlockService-BwsXifcj.js";import{L as G}from"./ListItem-BXiNssqK.js";import{L as $}from"./ListItemAvatar-BVyM9-Ti.js";import{A as z}from"./Avatar-CTIonlLm.js";import{L as q}from"./ListItemText-CY5tp-cQ.js";import{B as J}from"./Brightness1-DzlZaXtj.js";import{I as K}from"./IconButton-DcP_xRJ9.js";import{B as C,T as A}from"./Box-DXkLJjvK.js";import{M as Q}from"./Modal-BOfQSbY0.js";import{S as E}from"./Send-MfSLearV.js";import{G as U,C as V,a as W,P as X,T as Y,E as Z,b as ee,S as te,c as oe,d as re,F as se,R as ae}from"./grid.component-C-UJl6Wi.js";import{I as ie}from"./toolbar-DUNkpNtP.js";import{C as ne}from"./CustomSnackbar-G8VUdTuF.js";import{u as le}from"./SnackbarHook-vWpH4Y2e.js";import"./Paper-BEwslr8d.js";import"./useSlot-D00As9hZ.js";import"./Button-DN2uCHAG.js";import"./styles.module-DNUDPVkR.js";import"./BlockCategories-gKFyJIeZ.js";import"./Icon-8M-402I0.js";import"./mail-DB0D0Sj1.js";import"./createLucideIcon-CcfZQpLF.js";import"./smartphone-Ba5ETqIJ.js";import"./isHostComponent-CYuES88E.js";import"./MenuItem-CqmEd7jq.js";import"./listItemTextClasses-BIi4qrrm.js";import"./listItemButtonClasses-HyWYRFaA.js";import"./ListItemIcon-DD3KcyQi.js";import"./hook-BoUlgXeS.js";import"./Menu-Bg2AoiNO.js";import"./ThemeProvider-DYsQb5zk.js";import"./isMuiElement-CBKBaUeV.js";const ce={blocks:[],limit:"0",offset:0,search:"",count:0,next:()=>{},loading:!1,changeLimit:t=>{},onSearch:t=>{},activate:(t,s)=>{},deleteFn:(t,s)=>{},reorder:([])=>{}},I=x.createContext(ce),de=({value:t,children:s})=>e.jsx(I.Provider,{value:t,children:s}),w=()=>{const t=x.useContext(I);if(t===void 0)throw new Error("The context should be inside the provider!");return t},me=t=>e.jsxs(G,{sx:{padding:0},children:[e.jsx($,{children:e.jsx(z,{src:t.avatar})}),e.jsx(q,{primary:t.name,secondary:t.createdAt})]}),pe=t=>{const{activate:s,loading:a}=w(),i=()=>{s&&s(t.id,!t.isActive)};return e.jsx(K,{onClick:i,disabled:a,children:e.jsx(J,{color:t.isActive?"activate":"deactivate"})})},xe=t=>e.jsx(D,{href:`/admin/block/details/${t.id}`,children:e.jsx(S,{task:"display",text:""})}),ue="_modalStyle_1bxe6_1",he={modalStyle:ue},ge=t=>{const[s,a]=x.useState(!1),{deleteFn:i}=w(),m=()=>{a(!1)},h=()=>{a(!0)},f=()=>{i(t.id,t.category),a(!1)};return e.jsxs(C,{children:[e.jsx(S,{task:"delete",text:"",onClick:h}),e.jsx(Q,{open:s,onClose:m,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(C,{className:he.modalStyle,sx:{bgcolor:"background.paper",color:"text.primary",border:"2px solid"},children:[e.jsx(A,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Confirm Deletion Message"}),e.jsxs(A,{id:"modal-modal-description",sx:{mt:2},children:["Are you sure that you want to delete ",t.name]}),e.jsx(E,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:"m-[8px]",children:e.jsx(S,{task:"delete",text:"",onClick:f})})]})})]})},fe=[{type:"checkbox",width:"50"},{field:"name",headerText:"Name",width:"250",template:me,allowFiltering:!0,textAlign:"Center"},{field:"parent",headerText:"Parent",width:"150",textAlign:"Center"},{field:"isActive",headerText:"Status",width:"130",textAlign:"Center",template:pe},{headerText:"Edit",width:"130",textAlign:"Center",template:xe},{headerText:"Delete",width:"130",textAlign:"Center",template:ge}],ve=()=>{const t=j.get(L),{blocks:s,onSearch:a,reorder:i}=w();let m;const h={type:"Multiple"},f={type:"Excel"},y={pageSizes:k.PageSizes,pageSize:k.ListLimit,totalRecordsCount:3,pageCount:25},b=o=>{switch(o.requestType){case"paging":break;case"searching":o.searchString;break;case"rowdraganddrop":let l=[];o.rows?.map((v,p)=>{l=[...l,{id:v.data.id,order:p}]}),i(l);break}},B=o=>{if(o.rows!==void 0&&o.fromIndex!==void 0&&o.dropIndex!==void 0){o.cancel=!0;let l=[];for(let g=0;g<o?.rows?.length;g++)l.push(o?.fromIndex+g);m&&m.reorderRows(l,o.dropIndex)}};return e.jsx(C,{children:e.jsxs(U,{ref:o=>m=o,id:"blockComp",dataSource:t.mapBlocksGrid(s),allowPaging:!0,allowSorting:!0,allowFiltering:!0,allowExcelExport:!0,allowPdfExport:!0,toolbar:["Delete","Search"],editSettings:{allowDeleting:!0,showDeleteConfirmDialog:!0},filterSettings:f,pageSettings:y,actionComplete:b,allowRowDragAndDrop:!0,selectionSettings:h,rowDrop:B,children:[e.jsx(V,{children:fe.map((o,l)=>e.jsx(W,{...o},l))}),e.jsx(ie,{services:[X,Y,Z,ee,te,oe,re,se,ae]})]})})},ke=({blocks:t,count:s})=>{const[a,i]=x.useState(t),[m,h]=x.useState(t),[f,y]=x.useState(!1),[b,B]=x.useState(""),o=j.get(L),[l,g]=x.useState(k.FetchList[0]),{snackbar:v,setSnackbar:p,handleClose:T}=le(),F=c=>{g(c)},P=(c,u)=>{const d=new FormData;d.append("isActive",u?"true":"false"),o.blockActivation(d,c).then(r=>{i(a.map(n=>n.id===r.data.id?r.data:n)),h(m.map(n=>n.id===r.data.id?r.data:n)),p(n=>({...n,open:!0,message:`Block set as ${r.data.isActive?"Active":"Inactive"} `,severity:"success"}))}).catch(r=>{p(n=>({...n,open:!0,message:"Error happened while changing block status!",severity:"error"})),console.log(r)})},M=(c,u)=>{const d=new FormData;u&&d.append("category",u),o.deleteBlock(c,d).then(()=>{i(a.filter(r=>r.id!==c)),h(m.filter(r=>r.id!==c)),p(r=>({...r,open:!0,message:"Block has been deleted!",severity:"success"}))}).catch(r=>{p(n=>({...n,open:!0,message:"Error Happened while deleting block!",severity:"error"}))})},R=c=>{const u=new FormData;u.append("list",JSON.stringify(c)),o.reorder(u).then(()=>{p(d=>({...d,open:!0,message:"Blocks has been ordered!",severity:"success"}))}).catch(d=>{console.log(d),p(r=>({...r,open:!0,message:"Error Happened while reordering blocks!",severity:"error"}))})},H=c=>{},N=()=>{};return e.jsxs(de,{value:{blocks:a,limit:l,offset:0,search:"",count:s,next:N,loading:f,changeLimit:F,onSearch:H,activate:P,deleteFn:M,reorder:R},children:[e.jsx(ve,{}),e.jsx(ne,{open:v.open,message:v.message,onClose:T,severity:v.severity})]})},tt=({category:t,blocks:s})=>{const a=j.get(k),i=()=>a.toTitleCase(t);return e.jsxs(_,{children:[e.jsx(O,{title:i()}),e.jsx(C,{className:"py-[16px]",children:e.jsx(E,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:e.jsx(D,{href:`/admin/block/create/${t}`,children:e.jsx(S,{task:"add",text:i()})})})}),e.jsx(ke,{blocks:s,count:s.length})]})};export{tt as default};
